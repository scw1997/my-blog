# 移动端适配

主要介绍移动端适配中的一些重要概念和技术方案

## 各种“像素”

### 物理像素

又称**设备像素**，即我们平常主要所说的`分辨率的尺寸单位`，例如电脑和手机设备的屏幕分辨率。屏幕是由一个个的物理像素点组成的。例如手机分辨率为`1344 X 750`表示手机分别在垂直和水平方向的物理像素点数。一般来说，屏幕的物理像素点数是固定不变的，单位为pt。

### CSS像素

又称`设备独立像素`，平常写的CSS样式中的px尺寸单位即是CSS像素，而每个设备屏幕也都有自己对应的CSS像素尺寸。

![CSS像素.png](/css_px.png)

打开Chrome浏览器的移动端调试页面可看到对应页面上方有当前测试设备的相关信息。

这里的`375 X 812`表示的就是当前设备的CSS像素。当我们在设计网页时，进行移动页面样式调试，调试的样式尺寸基准就是CSS像素，而非物理像素。即当我们在页面中放一个width=375px，height为812px的div标签时，不考虑其他因素影响，在理想视口下（关于视口的介绍见下方），则它正好可以撑满当前设备整个屏幕。

### 设备像素比

DPR(Device Pixel Ratio)，设备像素比。它描述的是未缩放状态下，物理像素和CSS像素（设备独立像素）的初始比例关系。即表示每1px CSS像素所能包含的物理像素个数。

通常情况下计算公式为`DPR = 物理像素 / 设备独立像素（CSS像素）`,通过此公式便可得到CSS像素。

DPR越高，代表屏幕显示的精致程度越高。苹果手机的Retina高清屏则是经典案例，以DPR=2.0为例，则表示把一般的4(即2 X 2)个物理像素点数当作1(1 X 1)个CSS像素点数来用。

![设备像素比.png](/dpr.png)

**虽然DPR越高代表屏幕高清效果越好，但DPR越高会对一些网页显示素材（如图片）的质量（清晰度）要求也会越高**。举个常见的比较通俗易懂的例子，进行页面开发时，对于一些图片资源，UI会给我们提供分辨率相对于原始应该在页面上显示的CSS像素大小的2倍，3倍的图片文件。这些图片正是为了兼容DPR为2.0和3.0的设备的。

:::tip 举例说明
比如我们一个分辨率像素为100 X 100的图片在浏览器上也是设置CSS像素为100px * 100px,在dpr为1的设备上显示没有什么问题。但是如果是dpr=2的设备即水平或垂直方向上1css像素对应2个物理像素，则水平和垂直方向上分别只需要100/2=50个css像素就可标准清晰地显示该图片，但此时如果该图片依然设置100px * 100px的CSS像素，那么实际效果图片的每一个物理像素都会被拉伸成2个物理像素（1css像素）以便能撑满100px的CSS像素，所以图片显示效果变模糊一些。这时候使用2倍图(即200 X 200的图片)且CSS像素尺寸设置不变（100px * 100px）便可解决此问题。
:::

## 浏览器视口

移动设备上的视口（学术名称为viewport）就是设备的屏幕上能用来显示我们的网页的那一块区域。浏览器的视口主要分为以下几类：

### 布局视口

![布局视口.png](/layout_view.png)

布局视口表示的是`整个网页内容布局的矩形区域，页面元素的渲染永远不会超出这个区域`。


一般移动设备的浏览器都默认设置了一个 viewport 元标签，定义一个`虚拟的布局视口（layout viewport）`，用于解决早期的页面在手机上显示的问题。 iOS, Android 一般默认都将这个虚拟的布局视口分辨率设置为CSS像素的 `980px`，所以 PC 上的网页基本能在手机上呈现，只不过元素看上去很小，所以通常PC的网页在移动设备都是通过手动缩放来控制合适的页面显示大小。

:::tip
通常来讲，布局视口的尺寸与页面根元素html标签的CSS像素大小是一致的。所以js一般可通过`document.documentElement.clientWidth/clientHeight`来获取。（这个值不会因为html元素本身被设置了width或内部元素宽度超出当前视口宽度而变化）
:::

### 视觉视口

![可见视口.png](/visible_view.png)

又称可见视口，它表示的是布局视口中在当前设备中`可见`的矩形区域的那一部分。

`可见视口的尺寸大小会随着用户的手动缩放页面而变化`。放大时，可见的页面CSS像素减少；缩小时，可见的页面CSS像素增多。

### 理想视口

布局视口提供的默认视口尺寸并不是一个兼容多种设备的智能视口，所以提出了一个理想视口的概念。

通过在HTML中的头部head标签中添加关于viewport的meta标签可进行视口设置：

```html
 <meta name="viewport" content="width=device-width, user-scalable=yes,initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
```

属性 | 取值范围 |  作用
---|--- |---
width |正整数或device-width |定义视口的宽度，单位为CSS像素
height	|正整数或device-height|	定义视口的高度，单位为CSS像素，一般不用
initial-scale |	0.0-10.0	| 定义初始缩放值
minimum-scale |	0.0-10.0 |定义放大最大比例，它必须小于或等于maximum-scale设置
maximum-scale |	0.0-10.0|	定义缩小最小比例，它必须大于或等于minimum-scale设置
user-scalable |	yes / no |	定义是否允许用户手动缩放页面，默认值 yes


上面示例的meta标签代码代表的就是设置了一个理想视口：表示当前布局视口宽度与当前设备的CSS像素宽度一致，且默认不进行缩放。

这样设置后，可实现页面在所有设备上`默认布局视口宽度与设备屏幕宽度一致的自适应效果`。

:::warning 注意
- viewport的meta标签的设置`只对移动端生效`，不影响PC端视口。PC端视口大小一般固定为浏览器窗口的大小。
- 尽量不要禁用缩放（user-scalable设置为no）,避免为视力或行动有障碍的用户带来不便。
:::

## 适配方案

移动端web的适配方案从根本性质上可分为以下两类：

### 自适应

自适应（daptsive Web Design），这种适配方案通常来说同一个网站会拥有PC端，移动端两套网页代码（甚至更多）。通常移动端的页面功能和内容可能会相比PC端有所削减。而单纯针对移动端页面，则会表现“在不同尺寸的手机设备上，页面保持统一效果的等比缩放”的效果。

下面是我个人推荐的一套基于`vw/vh + rem`而设计的自适应适配方案：


### 响应式

