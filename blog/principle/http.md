# HTTP协议

## TCP/IP 协议族

`TCP/IP 协议族`是Internet最基本的协议，HTTP协议是它的一个`子集`。TCP/IP协议族按层次分为以下四层

- **应用层**

    负责处理网络应用程序之间的通信，如`FTP`协议（文件传输)，`HTTP`协议（Web通信），`DNS`协议（域名系统）。

- **传输层**

   提供处于网络连接中两台计算机之间的数据传输所使用的协议，如`UDP`协议（面向无连接，高效轻便），`TCP`协议（全双工通信，稳定可靠）。
   >TCP协议通信：[三次握手] & [四次挥手]

- **网络层**

   规定了数据通过怎样的传输路线到达对方计算机传送给对方，如`IP`协议。

- **链路层**

   用来处理连接网络的硬件部分（如网卡，光纤等）。



WEB应用的通信传输的一般流程：

![WEB通信](/tcp_ip.png)

## HTTP协议特点

- `无状态`：每一次请求都是独立的，请求结束不会记录连接的任何信息。
- `明文传输`：直接将明文信息暴露给了外界，存在一定安全隐患。
- `基于TCP协议`:HTTP 1.1之后默认开启持久连接（**Connection:Keep-Alive**），即多次HTTP请求只需使用一个TCP连接，减少了建立和关闭连接的消耗和延迟。

## HTTP报文

### 请求报文

请求报文由以下四部分组成：

- **请求行**：包含http请求方法，请求地址，http协议以及版本。
- **请求头**：以键值对形式存在的字段，展示该请求的一些规则参数。
- **空行**：用来区分请求头与请求体，因为请求头都是键值对的格式，当解析遇到空行时，服务端就知道下一个不再是请求头部分，就该当作请求体来解析了。
- **请求体**：请求资源所需要传递给服务器的数据。

![请求报文](/request_text.png)


### 响应报文

响应报文由以下四部分组成：

- **状态行**：包含http协议以及版本，响应状态码。
- **响应头**：以键值对形式存在的字段，展示该响应的一些规则参数。
- **空行**：用来区分响应头与响应体，因为响应头都是键值对的格式，当解析遇到空行时，服务端就知道下一个不再是响应头部分，就该当作响应体来解析了。
- **响应体**：服务端返回的资源信息。

![请求报文](/response_text.png)

### 首部字段

（1）通用字段

 - Cache-Control：控制缓存的行为，详解见：[这里](/principle/browser-cache#cache-control)

## 请求方法

- GET：获取资源
- POST：传输资源，通常会造成服务器资源的修改
- PUT：更新资源
- DELETE：删除资源
- HEAD：用于获取报文首部，不返回报文主体
- OPTIONS：列出请求资源支持的请求方法，用来跨域请求

其中最常用的是`GET`和`POST`方法，它们的区别主要有：

| 行为         | GET       | POST    |
|------------|-----------|---------|
| 浏览器回退      | 无影响       | 会再次发起请求 |
| 是否会被缓存     | 是         | 否       |
| 被浏览器保存历史记录 | 是         | 否       |
| 传递参数长度限制   | 是         | 否       |
| 参数传递方式     | 直接放在URL后面 | 请求体     |


[三次握手]:/principle/browser-render#网络请求
[四次挥手]:/principle/browser-render#断开连接
